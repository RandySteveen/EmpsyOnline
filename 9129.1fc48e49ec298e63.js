"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9129],{9129:(U,v,h)=>{h.r(v),h.d(v,{RaffleNumberPageModule:()=>D});var g=h(177),u=h(4341),a=h(9364),C=h(8986),p=h(467),F=h(8866),b=h(5312),y=h(9573),e=h(4438),_=h(1626);function j(i,c){if(1&i&&(e.j41(0,"ion-select-option",35),e.EFF(1),e.k0s()),2&i){const l=c.$implicit;e.Y8G("value",l.id_client),e.R7$(),e.SpI(" ",l.fullname," ")}}function N(i,c){if(1&i){const l=e.RV6();e.j41(0,"ion-item"),e.nrm(1,"ion-icon",10),e.j41(2,"ion-select",36),e.bIt("ionChange",function(n){e.eBV(l);const o=e.XpG();return e.Njj(o.selectBank(n))}),e.j41(3,"ion-select-option"),e.EFF(4,"Banco Venezuela"),e.k0s(),e.j41(5,"ion-select-option"),e.EFF(6,"Banco Provincial"),e.k0s(),e.j41(7,"ion-select-option"),e.EFF(8,"Banco Mercantil"),e.k0s(),e.j41(9,"ion-select-option"),e.EFF(10,"Banco Banesco"),e.k0s()()()}}function P(i,c){1&i&&(e.j41(0,"ion-item"),e.nrm(1,"ion-icon",10)(2,"ion-input",37),e.k0s()),2&i&&(e.R7$(2),e.Y8G("value",0))}let T=(()=>{var i;class c{constructor(t,n,o,s,r){this.modalController=t,this.fb=n,this.toastController=o,this.http=s,this.alertController=r,this.type_supervisor="",this.selectedBankImage="",this.initializeForm()}selectBank(t){this.selectedBankImage=t.detail.value}handlePaymentChange(t){const n=this.FormCash.get("amount_paid");n.enable(),"Apartado"===t.detail.value&&n.setValue(0)}initializeForm(){this.FormCash=this.fb.group({id_raffle:[""],id_supervisor:[""],type_supervisor:[""],id_client:[""],tickets_request:[[]],amount_total:[""],type_payment:[""],type_currency:[""],banck:[""],banck_reference:[""],amount_paid:[]})}removeLeadingZeros(t){return t.split(",").map(s=>parseInt(s.trim(),10)).join(",")}cerrarModal(){this.modalController.dismiss()}validarMonto(){var t=this;return(0,p.A)(function*(){var n,o;const s=null===(n=t.FormCash.get("type_payment"))||void 0===n?void 0:n.value,r=t.FormCash.get("amount_paid"),m=parseFloat(null===(o=t.FormCash.get("amount_total"))||void 0===o?void 0:o.value);"Apartado"===s?r.setValue(0):r.enable();const d=parseFloat(r.value);if("Al contado"===s&&r.enabled){if(d!==m)return(yield t.toastController.create({message:"El monto ingresado no coincide con el total a pagar.",duration:2500,position:"top",color:"danger"})).present(),!1}else if("A cuotas"===s&&r.enabled&&d>=m)return(yield t.toastController.create({message:"El monto ingresado no puede ser mayor o igual al total a pagar.",duration:2500,position:"top",color:"danger"})).present(),!1;return!0})()}abrirModal(){var t=this;return(0,p.A)(function*(){return yield(yield t.modalController.create({component:y.y,cssClass:"AddClient-Register",backdropDismiss:!1})).present()})()}presentToast(t){var n=this;return(0,p.A)(function*(){(yield n.toastController.create({message:t,duration:3e3,position:"top",color:"success"})).present()})()}ViewClient(){var t;null===(t=this.http.get(`${b.c.EmpsyClient}/all/${this.id_supervisor}/${this.type_supervisor}`))||void 0===t||t.subscribe(n=>{this.ItemClient=n.data.map(o=>({...o,mostrarDetalles:!1}))})}analizarToken(){const t=localStorage.getItem("Auth");if(t){const m=(0,F.s)(t);for(const d in m)if(m.hasOwnProperty(d)){if("id_seller"===d){var n,o;this.id_supervisor=m.id_seller,null===(n=this.FormCash.get("id_supervisor"))||void 0===n||n.setValue(this.id_supervisor),this.type_supervisor="VED",null===(o=this.FormCash.get("type_supervisor"))||void 0===o||o.setValue(this.type_supervisor);break}if("id_boss"===d){var s,r;this.id_supervisor=m.id_boss,null===(s=this.FormCash.get("id_supervisor"))||void 0===s||s.setValue(this.id_supervisor),this.type_supervisor="ADM",null===(r=this.FormCash.get("type_supervisor"))||void 0===r||r.setValue(this.type_supervisor);break}}}}ViewRaffle(){this.http.get(`${b.c.EmpsyRaffle}/all/${this.id}`).subscribe(t=>{console.log(t);const n=t.data.filter(o=>o.id_raffle===this.id_raffle);n.length>0&&(this.ItemRaffle=n,this.priceTickets=n[0].price_tickets,console.log(this.priceTickets),this.ticket_sold=n[0].tickets_sold,this.calcularMontoTotal())})}Submit(){var t=this;return(0,p.A)(function*(){var s;(yield t.validarMonto())?yield(yield t.alertController.create({header:"Registrar",message:"Registrar Pago",buttons:[{text:"Cancelar",role:"Cancel",handler:()=>{}},{text:"Aceptar",handler:(s=(0,p.A)(function*(){try{console.log(t.FormCash.value),yield t.http.post(`${b.c.EmpsyTickets}/save/ticket`,t.FormCash.value).toPromise(),t.presentToast("Pago Agregado Con Exito.."),console.log(t.FormCash.value),setTimeout(()=>{location.reload()},2500)}catch(r){console.error("Error al enviar el formulario al backend:",r)}}),function(){return s.apply(this,arguments)})}]})).present():(yield t.toastController.create({message:"No se pueden enviar los datos porque el monto no es v\xe1lido.",duration:2500,position:"top",color:"danger"})).present()})()}calcularMontoTotal(){if(this.numbersWithoutZeros||this.priceTickets){var t;const n=this.numbersWithoutZeros.split(","),o=this.priceTickets*n.length;console.log("el total a pagar es ",o),null===(t=this.FormCash.get("amount_total"))||void 0===t||t.setValue(o)}else console.error("No se pueden calcular los montos debido a datos faltantes.")}ionViewWillEnter(){var t,n;const o=this.numbers.toString();this.numbersWithoutZeros=this.removeLeadingZeros(o),this.analizarToken();const s=localStorage.getItem("Auth");if(s){const f=(0,F.s)(s);this.id=f.id_boss||f.id_seller}const r=localStorage.getItem("tasaBS"),m=localStorage.getItem("tasaCop");if(null!==r&&null!==m)try{this.TasaBS=JSON.parse(r),this.TasaCop=JSON.parse(m)}catch(f){console.error("Error al analizar los valores del cach\xe9:",f)}else console.log("No se encontraron valores en el cach\xe9.");this.ViewRaffle(),this.ViewClient(),this.calcularMontoTotal();const d=this.numbersWithoutZeros.split(",").map(f=>parseInt(f,10));null===(t=this.FormCash.get("tickets_request"))||void 0===t||t.setValue(d),null===(n=this.FormCash.get("id_raffle"))||void 0===n||n.setValue(this.id_raffle)}formatTickets(t){return t.slice(1,-1)}}return(i=c).\u0275fac=function(t){return new(t||i)(e.rXU(a.W3),e.rXU(u.ok),e.rXU(a.K_),e.rXU(_.Qq),e.rXU(a.hG))},i.\u0275cmp=e.VBU({type:i,selectors:[["app-cash"]],inputs:{id_raffle:"id_raffle",numbers:"numbers"},decls:88,vars:20,consts:[["color","dark"],["align","center"],["slot","end"],[3,"click"],["slot","icon-only","name","close","color","danger"],["Scroll-Y","true",3,"translate"],[1,"center-title"],[1,"label-title"],["name","warning-outline",1,"icon-form"],[3,"formGroup"],["name","warning-outline","slot","start",1,"icon-register"],["placeholder","Seleccionar Cliente","formControlName","id_client","interface","action-sheet"],[3,"value",4,"ngFor","ngForOf"],["color","primary","slot","end",2,"max-width","20%",3,"click"],["name","add"],["label","Numeros a Jugar","formControlName","tickets_request","type","text","readonly","true",3,"value"],["placeholder","Seleccionar Pago","formControlName","type_payment","interface","action-sheet",3,"ionChange"],["value","Al contado"],["value","A cuotas"],["value","Apartado"],["placeholder","Seleccionar Moneda","formControlName","type_currency",3,"disabled"],["value","bolivares"],["value","pesos"],["value","dolares"],["value","zelle"],["value","CML"],["value","bni"],["value","pay"],[4,"ngIf"],["placeholder","Ingrese Monto Recibido","type","tel","inputmode","numeric","formControlName","amount_paid",3,"input"],["slot","start","name","cash-outline","color","success"],["placeholder","Total a Pagar","type","tel","inputmode","numeric","readonly","true","formControlName","amount_total"],[1,"center-information"],["expand","block","color","tertiary",3,"click"],["expand","block","color","danger",3,"click"],[3,"value"],["placeholder","Seleccione Banco","formControlName","banck","interface","action-sheet",3,"ionChange"],["placeholder","Ingrese Referencia Bancaria","formControlName","banck_reference",3,"value"]],template:function(t,n){if(1&t&&(e.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title",1),e.EFF(3,"Registrar Pago"),e.k0s(),e.j41(4,"ion-buttons",2)(5,"ion-button",3),e.bIt("click",function(){return n.cerrarModal()}),e.nrm(6,"ion-icon",4),e.k0s()()()(),e.j41(7,"ion-content",5)(8,"div",6)(9,"ion-title",7),e.EFF(10,"Completa los campos "),e.nrm(11,"ion-icon",8),e.k0s()(),e.nrm(12,"hr"),e.j41(13,"form",9)(14,"ion-item"),e.nrm(15,"ion-icon",10),e.j41(16,"ion-select",11),e.DNE(17,j,2,2,"ion-select-option",12),e.k0s(),e.j41(18,"ion-button",13),e.bIt("click",function(){return n.abrirModal()}),e.nrm(19,"ion-icon",14),e.k0s()(),e.nrm(20,"br"),e.j41(21,"ion-item"),e.nrm(22,"ion-icon",10)(23,"ion-input",15),e.k0s(),e.nrm(24,"br"),e.j41(25,"ion-item"),e.nrm(26,"ion-icon",10),e.j41(27,"ion-select",16),e.bIt("ionChange",function(s){return n.handlePaymentChange(s)}),e.j41(28,"ion-select-option",17),e.EFF(29,"-Contado"),e.k0s(),e.j41(30,"ion-select-option",18),e.EFF(31,"-Abono"),e.k0s(),e.j41(32,"ion-select-option",19),e.EFF(33,"-Apartado"),e.k0s()()(),e.nrm(34,"br"),e.j41(35,"ion-item"),e.nrm(36,"ion-icon",10),e.j41(37,"ion-select",20)(38,"ion-select-option",21),e.EFF(39,"Bs"),e.k0s(),e.j41(40,"ion-select-option",22),e.EFF(41,"Pesos Colombianos"),e.k0s(),e.j41(42,"ion-select-option",23),e.EFF(43,"Dolar EstadoUnidense"),e.k0s(),e.j41(44,"ion-select-option",24),e.EFF(45,"ZELLE"),e.k0s(),e.j41(46,"ion-select-option",25),e.EFF(47,"Bancolombia"),e.k0s(),e.j41(48,"ion-select-option",26),e.EFF(49,"Binance"),e.k0s(),e.j41(50,"ion-select-option",27),e.EFF(51,"Paypal"),e.k0s()()(),e.nrm(52,"br"),e.DNE(53,N,11,0,"ion-item",28),e.nrm(54,"br"),e.DNE(55,P,3,1,"ion-item",28),e.nrm(56,"br"),e.j41(57,"ion-item"),e.nrm(58,"ion-icon",10),e.j41(59,"ion-input",29),e.bIt("input",function(){return n.validarMonto()}),e.k0s()(),e.nrm(60,"br"),e.j41(61,"ion-item"),e.nrm(62,"ion-icon",30)(63,"ion-input",31),e.k0s(),e.nrm(64,"br"),e.j41(65,"div",32)(66,"ion-list")(67,"ion-item")(68,"ion-label"),e.EFF(69),e.nI1(70,"number"),e.k0s()(),e.j41(71,"ion-item")(72,"ion-label"),e.EFF(73),e.nI1(74,"number"),e.k0s()(),e.j41(75,"ion-item")(76,"ion-label"),e.EFF(77),e.nI1(78,"number"),e.k0s()(),e.j41(79,"ion-item")(80,"ion-label"),e.EFF(81),e.k0s()(),e.nrm(82,"ion-item"),e.k0s()()(),e.j41(83,"ion-button",33),e.bIt("click",function(){return n.Submit()}),e.EFF(84,"Guardar"),e.k0s(),e.nrm(85,"br"),e.j41(86,"ion-button",34),e.bIt("click",function(){return n.cerrarModal()}),e.EFF(87,"Salir"),e.k0s()()),2&t){let o,s,r,m,d,f;e.R7$(7),e.Y8G("translate",!0),e.R7$(6),e.Y8G("formGroup",n.FormCash),e.R7$(4),e.Y8G("ngForOf",n.ItemClient),e.R7$(6),e.Y8G("value",n.numbersWithoutZeros),e.R7$(14),e.Y8G("disabled","Apartado"===(null==(o=n.FormCash.get("type_payment"))?null:o.value)),e.R7$(16),e.Y8G("ngIf","bolivares"===(null==(s=n.FormCash.get("type_currency"))?null:s.value)),e.R7$(2),e.Y8G("ngIf","bolivares"===(null==(r=n.FormCash.get("type_currency"))?null:r.value)||"zelle"===(null==(r=n.FormCash.get("type_currency"))?null:r.value)||"CML"===(null==(r=n.FormCash.get("type_currency"))?null:r.value)||"bni"===(null==(r=n.FormCash.get("type_currency"))?null:r.value)||"pay"===(null==(r=n.FormCash.get("type_currency"))?null:r.value)),e.R7$(14),e.SpI(" Bolivares : ",e.i5U(70,11,(null==(m=n.FormCash.get("amount_total"))?null:m.value)*n.TasaBS,"1.2-2")," "),e.R7$(4),e.SpI(" Pesos Colombianos : ",e.i5U(74,14,(null==(d=n.FormCash.get("amount_total"))?null:d.value)*n.TasaCop,"1.2-2")," "),e.R7$(4),e.SpI(" Dolar : ",e.i5U(78,17,null==(f=n.FormCash.get("amount_total"))?null:f.value,"1.2-2")," "),e.R7$(4),e.SpI(" Numeros no Disponibles : ",n.formatTickets(n.ticket_sold)," ")}},dependencies:[g.Sq,g.bT,u.qT,u.BC,u.cb,a.Jm,a.QW,a.W9,a.eU,a.iq,a.$w,a.uz,a.he,a.nf,a.Nm,a.Ip,a.BC,a.ai,a.Je,a.Gw,u.j4,u.JD,g.QX],styles:['ion-title[_ngcontent-%COMP%]{font-family:Poppins,sans-serif;font-weight:900;text-align:center;line-height:1;margin:0}.label-title[_ngcontent-%COMP%]{align-items:center;text-align:center;font-size:1.3em;font-family:"",sans-serif;font-weight:300,bold;font-style:normal}ion-input[_ngcontent-%COMP%]{border-radius:10%}.icon-register[_ngcontent-%COMP%]{font-size:1em;color:red}.custom-icon[_ngcontent-%COMP%]{width:30px;height:30px}.center-title[_ngcontent-%COMP%]{justify-content:center;text-align:center;align-items:center}.icon-form[_ngcontent-%COMP%]{font-size:1em;color:red;margin-left:5px;margin-right:5px;margin-top:5px}.center-information[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{justify-content:center;align-items:center;text-align:center}']}),c})();function E(i,c){1&i&&(e.j41(0,"ion-item"),e.nrm(1,"ion-icon",10),e.j41(2,"ion-select",28)(3,"ion-select-option",29),e.EFF(4,"Banco Venezuela"),e.k0s(),e.j41(5,"ion-select-option",30),e.EFF(6,"Banco Provincial"),e.k0s(),e.j41(7,"ion-select-option",31),e.EFF(8,"Banco Mercantil"),e.k0s(),e.j41(9,"ion-select-option",32),e.EFF(10,"Banco Banesco"),e.k0s(),e.j41(11,"ion-select-option",33),e.EFF(12,"Banco BNC"),e.k0s()()())}function M(i,c){1&i&&(e.j41(0,"ion-item"),e.nrm(1,"ion-icon",10)(2,"ion-input",34),e.k0s()),2&i&&(e.R7$(2),e.Y8G("value",0))}let R=(()=>{var i;class c{constructor(t,n,o,s,r){this.http=t,this.modalController=n,this.toastController=o,this.fb=s,this.alertController=r,this.FormCash=this.fb.group({id_ticket:new u.MJ(""),type_payment:new u.MJ("",u.k0.required),type_currency:new u.MJ("",u.k0.required),banck:new u.MJ(""),banck_reference:new u.MJ(""),amount_paid:new u.MJ(0)})}cerrarModal(){this.modalController.dismiss()}validarMonto(){var t=this;return(0,p.A)(function*(){var n,o;const s=parseFloat(null===(n=t.FormCash.get("amount_paid"))||void 0===n?void 0:n.value),r=parseFloat(t.totalapagar),m=null===(o=t.FormCash.get("type_payment"))||void 0===o?void 0:o.value;if(console.log("Monto Recibido:",s),console.log("Total a Pagar:",r),"Al contado"===m){if(s!==r)return(yield t.toastController.create({message:"El monto ingresado no puede ser mayor o menor que el total a pagar",duration:3500,position:"top",color:"danger"})).present(),!1}else if("A cuotas"===m&&s>=r)return(yield t.toastController.create({message:"El monto ingresado debe ser menor al total a pagar.",duration:3500,position:"top",color:"danger"})).present(),!1;return!0})()}ngOnInit(){var t;setTimeout(()=>{this.calcularTotalAPagar()},2e3),null===(t=this.FormCash.get("id_ticket"))||void 0===t||t.setValue(this.id_ticket),console.log(this.totalapagar)}calcularTotalAPagar(){this.totalapagar=this.amount_total-this.amount_paid,console.log(this.id_ticket)}Submit(){var t=this;return(0,p.A)(function*(){var s;(yield t.validarMonto())?yield(yield t.alertController.create({header:"Registrar",message:"Registrar Pago",buttons:[{text:"Cancelar",role:"Cancel",handler:()=>{}},{text:"Aceptar",handler:(s=(0,p.A)(function*(){try{t.FormCash.value.amount_paid=parseFloat(t.FormCash.value.amount_paid),console.log(t.FormCash.value),yield t.http.post(`${b.c.EmpsyTickets}/save/payment`,t.FormCash.value).toPromise(),t.presentToast("Pago Agregado Con Exito.."),setTimeout(()=>{location.reload()},2500)}catch(r){console.error("Error al enviar el formulario al backend:",r)}}),function(){return s.apply(this,arguments)})}]})).present():(yield t.toastController.create({message:"No se pueden enviar los datos porque el monto no es v\xe1lido.",duration:2500,position:"top",color:"danger"})).present()})()}presentToast(t){var n=this;return(0,p.A)(function*(){(yield n.toastController.create({message:t,duration:3e3,position:"top",color:"success"})).present()})()}}return(i=c).\u0275fac=function(t){return new(t||i)(e.rXU(_.Qq),e.rXU(a.W3),e.rXU(a.K_),e.rXU(u.ok),e.rXU(a.hG))},i.\u0275cmp=e.VBU({type:i,selectors:[["app-cash-paid"]],inputs:{id_ticket:"id_ticket",amount_total:"amount_total",amount_paid:"amount_paid"},decls:57,vars:6,consts:[["color","dark"],["align","center"],["slot","end"],[3,"click"],["slot","icon-only","name","close","color","danger"],["Scroll-Y","true",3,"translate"],[1,"center-title"],[1,"label-title"],["name","warning-outline",1,"icon-form"],[3,"formGroup"],["name","warning-outline","slot","start",1,"icon-register"],["placeholder","Seleccionar Pago","formControlName","type_payment",3,"ionChange"],["value","Al contado"],["value","A cuotas"],["placeholder","Seleccionar Moneda","formControlName","type_currency",3,"disabled"],["value","bolivares"],["value","pesos"],["value","dolares"],["value","zelle"],["value","CML"],["value","bni"],["value","pay"],[4,"ngIf"],["placeholder","Ingrese Monto Recibido","type","tel","inputmode","numeric","formControlName","amount_paid",3,"input"],["slot","start","name","cash-outline","color","success"],["placeholder","Total a Pagar","readonly","true",3,"value"],["expand","block","color","tertiary",3,"click"],["expand","block","color","danger",3,"click"],["placeholder","Seleccione Banco","formControlName","banck","value","BV"],["value","BV"],["value","BP"],["value","BM"],["value","BB"],["value","BBNC"],["placeholder","Ingrese Referencia Bancaria","formControlName","banck_reference",3,"value"]],template:function(t,n){if(1&t&&(e.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title",1),e.EFF(3,"Registrar Abono"),e.k0s(),e.j41(4,"ion-buttons",2)(5,"ion-button",3),e.bIt("click",function(){return n.cerrarModal()}),e.nrm(6,"ion-icon",4),e.k0s()()()(),e.j41(7,"ion-content",5)(8,"div",6)(9,"ion-title",7),e.EFF(10,"Completa los campos "),e.nrm(11,"ion-icon",8),e.k0s()(),e.nrm(12,"hr"),e.j41(13,"form",9)(14,"ion-item"),e.nrm(15,"ion-icon",10),e.j41(16,"ion-select",11),e.bIt("ionChange",function(){return n.validarMonto()}),e.j41(17,"ion-select-option",12),e.EFF(18,"Contado"),e.k0s(),e.j41(19,"ion-select-option",13),e.EFF(20,"Abono"),e.k0s()()(),e.nrm(21,"br"),e.j41(22,"ion-item"),e.nrm(23,"ion-icon",10),e.j41(24,"ion-select",14)(25,"ion-select-option",15),e.EFF(26,"Bs"),e.k0s(),e.j41(27,"ion-select-option",16),e.EFF(28,"Pesos Colombianos"),e.k0s(),e.j41(29,"ion-select-option",17),e.EFF(30,"Dolar EstadoUnidense"),e.k0s(),e.j41(31,"ion-select-option",18),e.EFF(32,"ZELLE"),e.k0s(),e.j41(33,"ion-select-option",19),e.EFF(34,"Bancolombia"),e.k0s(),e.j41(35,"ion-select-option",20),e.EFF(36,"Binance"),e.k0s(),e.j41(37,"ion-select-option",21),e.EFF(38,"Paypal"),e.k0s()()(),e.nrm(39,"br"),e.DNE(40,E,13,0,"ion-item",22),e.nrm(41,"br"),e.DNE(42,M,3,1,"ion-item",22),e.nrm(43,"br"),e.j41(44,"ion-item"),e.nrm(45,"ion-icon",10),e.j41(46,"ion-input",23),e.bIt("input",function(){return n.validarMonto()}),e.k0s()(),e.nrm(47,"br"),e.j41(48,"ion-item"),e.nrm(49,"ion-icon",24)(50,"ion-input",25),e.k0s(),e.nrm(51,"br"),e.k0s(),e.j41(52,"ion-button",26),e.bIt("click",function(){return n.Submit()}),e.EFF(53,"Guardar"),e.k0s(),e.nrm(54,"br"),e.j41(55,"ion-button",27),e.bIt("click",function(){return n.cerrarModal()}),e.EFF(56,"Salir"),e.k0s()()),2&t){let o,s,r;e.R7$(7),e.Y8G("translate",!0),e.R7$(6),e.Y8G("formGroup",n.FormCash),e.R7$(11),e.Y8G("disabled","Apartado"===(null==(o=n.FormCash.get("type_payment"))?null:o.value)),e.R7$(16),e.Y8G("ngIf","bolivares"===(null==(s=n.FormCash.get("type_currency"))?null:s.value)),e.R7$(2),e.Y8G("ngIf","bolivares"===(null==(r=n.FormCash.get("type_currency"))?null:r.value)||"zelle"===(null==(r=n.FormCash.get("type_currency"))?null:r.value)||"CML"===(null==(r=n.FormCash.get("type_currency"))?null:r.value)||"bni"===(null==(r=n.FormCash.get("type_currency"))?null:r.value)||"pay"===(null==(r=n.FormCash.get("type_currency"))?null:r.value)),e.R7$(8),e.Y8G("value",n.totalapagar)}},dependencies:[g.bT,u.qT,u.BC,u.cb,a.Jm,a.QW,a.W9,a.eU,a.iq,a.$w,a.uz,a.Nm,a.Ip,a.BC,a.ai,a.Je,a.Gw,u.j4,u.JD],styles:['ion-title[_ngcontent-%COMP%]{font-family:Poppins,sans-serif;font-weight:900;text-align:center;line-height:1;margin:0}.label-title[_ngcontent-%COMP%]{align-items:center;text-align:center;font-size:1.3em;font-family:"",sans-serif;font-weight:300,bold;font-style:normal}ion-input[_ngcontent-%COMP%]{border-radius:10%}.icon-register[_ngcontent-%COMP%]{font-size:1em;color:red}.custom-icon[_ngcontent-%COMP%]{width:30px;height:30px}.center-title[_ngcontent-%COMP%]{justify-content:center;text-align:center;align-items:center}.icon-form[_ngcontent-%COMP%]{font-size:1em;color:red;margin-left:5px;margin-right:5px;margin-top:5px}.center-information[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{justify-content:center;align-items:center;text-align:center}']}),c})();h(5083);function x(i,c){if(1&i){const l=e.RV6();e.j41(0,"div",9)(1,"h2",10),e.EFF(2,"Nombre del cliente:"),e.k0s(),e.j41(3,"p"),e.EFF(4),e.k0s(),e.nrm(5,"br"),e.j41(6,"h2",10),e.EFF(7,"Telefono:"),e.k0s(),e.j41(8,"p"),e.EFF(9),e.k0s(),e.nrm(10,"br"),e.j41(11,"h2",10),e.EFF(12,"Direcci\xf3n:"),e.k0s(),e.j41(13,"p"),e.EFF(14),e.k0s(),e.nrm(15,"br"),e.j41(16,"h2",10),e.EFF(17,"Estado:"),e.k0s(),e.j41(18,"p"),e.EFF(19),e.k0s(),e.j41(20,"h2",10),e.EFF(21,"Sector:"),e.k0s(),e.j41(22,"p"),e.EFF(23),e.k0s(),e.nrm(24,"br"),e.j41(25,"div",11)(26,"ion-button",12),e.bIt("click",function(){const n=e.eBV(l).$implicit,o=e.XpG();return e.Njj(o.openWhatsApp(n.phone))}),e.nrm(27,"ion-icon",13),e.EFF(28,"WhatsApp"),e.k0s()()()}if(2&i){const l=c.$implicit;e.R7$(4),e.JRh(l.client_fullname),e.R7$(5),e.JRh(l.phone),e.R7$(5),e.JRh(l.direction),e.R7$(5),e.SpI(" ",l.state,""),e.R7$(4),e.SpI(" ",l.sector," ")}}function A(i,c){if(1&i){const l=e.RV6();e.j41(0,"ion-button",15),e.bIt("click",function(){e.eBV(l);const n=e.XpG().$implicit,o=e.XpG();return e.Njj(o.openModal(n.amount_paid,n.amount_total,n.id_ticket))}),e.EFF(1," Abonar "),e.k0s()}}function S(i,c){if(1&i&&(e.j41(0,"div",9)(1,"h2",10),e.EFF(2,"Ticket Seleccionado:"),e.k0s(),e.j41(3,"p"),e.EFF(4,"12"),e.k0s(),e.nrm(5,"br"),e.j41(6,"h2",10),e.EFF(7,"Tickets Jugados:"),e.k0s(),e.j41(8,"p"),e.EFF(9),e.k0s(),e.nrm(10,"br"),e.j41(11,"h2",10),e.EFF(12,"Valor del Boleto (C/U):"),e.k0s(),e.j41(13,"p"),e.EFF(14),e.k0s(),e.nrm(15,"br"),e.j41(16,"h2",10),e.EFF(17,"Fecha de compra:"),e.k0s(),e.j41(18,"p"),e.EFF(19),e.nI1(20,"date"),e.k0s(),e.nrm(21,"br"),e.j41(22,"h2",10),e.EFF(23,"Monto a Pagar:"),e.k0s(),e.j41(24,"p"),e.EFF(25),e.k0s(),e.nrm(26,"br"),e.j41(27,"h2",10),e.EFF(28,"Monto Abonado:"),e.k0s(),e.j41(29,"p"),e.EFF(30),e.k0s(),e.nrm(31,"br"),e.j41(32,"div",11),e.DNE(33,A,2,0,"ion-button",14),e.k0s()()),2&i){const l=c.$implicit,t=e.XpG();e.R7$(9),e.JRh(t.formatTickets(l.tickets_sold)),e.R7$(5),e.SpI("",l.price_tickets," $"),e.R7$(5),e.JRh(e.i5U(20,6,l.date_created,"dd/MM/yyyy")),e.R7$(6),e.SpI("",l.amount_total," $"),e.R7$(5),e.SpI("",l.amount_paid," $"),e.R7$(3),e.Y8G("ngIf",1!==l.status_ticket)}}let $=(()=>{var i;class c{constructor(t,n){this.http=t,this.modalController=n,this.items=[]}openModal(t,n,o){var s=this;return(0,p.A)(function*(){return yield(yield s.modalController.create({component:R,componentProps:{id_ticket:o,amount_total:n,amount_paid:t}})).present()})()}ngOnInit(){this.numberWithoutZeros=this.removeLeadingZeros(this.number),this.ViewInfoNumber()}ViewInfoNumber(){this.http.get(`${b.c.EmpsyTickets}/detailed/ticket/${this.id_raffle}/${this.numberWithoutZeros}`).subscribe(t=>{this.items=t.info,console.log(this.items)})}cerrarModal(){this.modalController.dismiss()}removeLeadingZeros(t){return parseInt(t,10).toString()}formatTickets(t){return t.slice(1,-1)}isWhatsAppInstalled(){return(0,p.A)(function*(){let t;const n=navigator.userAgent||navigator.vendor;return t=n&&-1!==n.indexOf("WhatsApp")?"whatsapp://send":"https://api.whatsapp.com",t})()}openWhatsApp(t){return(0,p.A)(function*(){const n=t.startsWith("+58")?t:"+58"+t,o=`whatsapp://send?phone=${encodeURIComponent(n)}`;window.location.href=o,setTimeout(()=>{const s=`https://api.whatsapp.com/send?phone=${encodeURIComponent(n)}`;window.location.href=s},1e3)})()}}return(i=c).\u0275fac=function(t){return new(t||i)(e.rXU(_.Qq),e.rXU(a.W3))},i.\u0275cmp=e.VBU({type:i,selectors:[["app-detailed-number"]],inputs:{id_raffle:"id_raffle",number:"number"},decls:19,vars:3,consts:[["color","dark"],["align","center"],["slot","end"],[3,"click"],["slot","icon-only","name","close","color","danger"],["Scroll-Y","true",3,"translate"],[1,"label-title"],[1,"detalle-container"],["class","detalle-item",4,"ngFor","ngForOf"],[1,"detalle-item"],[1,"detalle-title"],[1,"button-container"],["color","success",3,"click"],["name","logo-whatsapp"],["expand","block","color","tertiary",3,"click",4,"ngIf"],["expand","block","color","tertiary",3,"click"]],template:function(t,n){1&t&&(e.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title",1),e.EFF(3,"Detalle del N\xfamero"),e.k0s(),e.j41(4,"ion-buttons",2)(5,"ion-button",3),e.bIt("click",function(){return n.cerrarModal()}),e.nrm(6,"ion-icon",4),e.k0s()()()(),e.j41(7,"ion-content",5)(8,"ion-title",6),e.EFF(9,"Datos del Cliente"),e.k0s(),e.j41(10,"div",7),e.DNE(11,x,29,5,"div",8),e.nrm(12,"br"),e.j41(13,"ion-title",6),e.EFF(14,"Informaci\xf3n del Ticket"),e.k0s(),e.nrm(15,"br"),e.DNE(16,S,34,9,"div",8),e.k0s(),e.nrm(17,"br")(18,"br"),e.k0s()),2&t&&(e.R7$(7),e.Y8G("translate",!0),e.R7$(4),e.Y8G("ngForOf",n.items),e.R7$(5),e.Y8G("ngForOf",n.items))},dependencies:[g.Sq,g.bT,a.Jm,a.QW,a.W9,a.eU,a.iq,a.BC,a.ai,g.vh],styles:["ion-title[_ngcontent-%COMP%]{font-family:Poppins,sans-serif;font-weight:900;text-align:center;line-height:1;margin:0}.detalle-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:5px;padding:10px}.label-title[_ngcontent-%COMP%]{font-family:Poppins,sans-serif;font-weight:900;text-align:center;line-height:1;margin:10px 0 5px;font-size:22px}.detalle-item[_ngcontent-%COMP%]{background-color:#f5f5f5;padding:10px;border-radius:10px}.detalle-title[_ngcontent-%COMP%]{font-family:Poppins,sans-serif;font-size:20px;margin-bottom:10px;font-weight:700;line-height:1;margin-top:10px}.detalle-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 7px;font-size:18px;font-weight:500;font-family:Roboto,sans-serif;text-align:center}.button-container[_ngcontent-%COMP%]{display:flex;flex-direction:initial;justify-content:center;align-items:center;margin-top:20px}ion-button[_ngcontent-%COMP%]{margin-bottom:10px}.button-center[_ngcontent-%COMP%]{justify-content:center;display:flex;align-items:center;text-align:center;margin:0 8px}"]}),c})();const B=(i,c,l)=>({sold:i,subs:c,apart:l});function O(i,c){if(1&i){const l=e.RV6();e.j41(0,"ion-button",17),e.bIt("touchstart",function(n){e.eBV(l);const o=e.XpG();return e.Njj(o.onTouchMove(n))})("click",function(){e.eBV(l);const n=e.XpG();return e.Njj(n.openModal())}),e.EFF(1),e.k0s()}if(2&i){const l=e.XpG();e.R7$(),e.SpI(" ",l.contador," ")}}function w(i,c){if(1&i){const l=e.RV6();e.j41(0,"button",18),e.bIt("click",function(){const n=e.eBV(l).$implicit,o=e.XpG();return e.Njj(o.navRoutin(n))})("click",function(){const n=e.eBV(l).$implicit,o=e.XpG();return e.Njj(o.navRouting(n))}),e.EFF(1),e.k0s()}if(2&i){const l=c.$implicit,t=e.XpG();e.Y8G("ngClass",e.sMw(3,B,t.isSold(l),t.isSubs(l),t.isApart(l))),e.BMQ("data-number",l),e.R7$(),e.SpI(" ",l," ")}}const V=[{path:"",component:(()=>{var i;class c{constructor(t,n,o,s,r){this.route=t,this.http=n,this.modalController=o,this.elementRef=s,this.toastController=r,this.numbers_raffle=[],this.filteredNumbers=[],this.searchNumber="",this.soldTickets=[],this.subsTickets=[],this.apartTickets=[],this.selectedNumbers=[],this.contador=0,this.isButtonVisible=!0}ngOnInit(){this.id_raffle=Number(this.route.snapshot.paramMap.get("id_raffle")),this.ViewDataRaffle()}ViewDataRaffle(){this.http.get(`${b.c.EmpsyTickets}/tickets/${this.id_raffle}`).subscribe(t=>{if(console.log(t),"number"==typeof t.numbers_raffle){const n=t.numbers_raffle.toString().length;this.numbers_raffle=Array.from({length:t.numbers_raffle},(o,s)=>this.formatNumber(s,n))}else if(Array.isArray(t.numbers_raffle)){const o=Math.max(...t.numbers_raffle).toString().length;this.numbers_raffle=t.numbers_raffle.map(s=>this.formatNumber(s,o))}this.soldTickets=this.formatTicketNumbers(t.soldTickets||[]),this.subsTickets=this.formatTicketNumbers(t.subsTickets||[]),this.apartTickets=this.formatTicketNumbers(t.apartTickets||[]),this.filteredNumbers=this.numbers_raffle.slice()})}onTouchMove(t){const n=this.elementRef.nativeElement.querySelector(".draggable"),o=t.touches[0].clientX-n.offsetLeft,s=t.touches[0].clientY-n.offsetTop,r=d=>{let f=d.touches[0].clientX-o,k=d.touches[0].clientY-s;f=Math.max(0,Math.min(window.innerWidth-n.offsetWidth,f)),k=Math.max(0,Math.min(window.innerHeight-n.offsetHeight,k)),n.style.left=f+"px",n.style.top=k+"px"},m=()=>{document.removeEventListener("touchmove",r),document.removeEventListener("touchend",m)};document.addEventListener("touchmove",r),document.addEventListener("touchend",m)}onWindowScroll(){const t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;this.isButtonVisible=t<window.innerHeight}formatNumberWithoutCommas(t,n){return t.toString().replace(/,/g,"").padStart(n,"0")}formatTicketNumbers(t){return t.map(n=>this.formatNumberWithoutCommas(n,this.numbers_raffle[0].length))}isSold(t){return this.soldTickets.includes(t)}isSubs(t){return this.subsTickets.includes(t)}isApart(t){return this.apartTickets.includes(t)}formatNumber(t,n){return t.toString().padStart(n,"0").replace(/(\d{3})/g,"$1")}filterNumbers(t){const o=parseInt(t.detail.value,10);if(isNaN(o))this.filteredNumbers=this.numbers_raffle.slice();else{const s=o.toString().padStart(this.numbers_raffle[0].length,"0");this.filteredNumbers=this.numbers_raffle.filter(r=>r===s)}}filterByCategory(t){"available"===t?this.filteredNumbers=this.numbers_raffle.filter(n=>!this.isSold(n)&&!this.isSubs(n)):"sold"===t?this.filteredNumbers=this.soldTickets:"subs"===t?this.filteredNumbers=this.subsTickets:"apartados"===t&&(this.filteredNumbers=this.apartTickets)}navRoutin(t){var n=this;return(0,p.A)(function*(){if(n.isSold(t)||n.isSubs(t)||n.isApart(t))return yield(yield n.modalController.create({component:$,componentProps:{id_raffle:n.id_raffle,number:t}})).present();n.presentToast("El ticket no ha sido vendido y sigue estando disponible.")})()}presentToast(t){var n=this;return(0,p.A)(function*(){(yield n.toastController.create({message:t,duration:2e3,position:"top",color:"danger"})).present()})()}navRouting(t){var n=this;return(0,p.A)(function*(){if(n.isSold(t)||n.isSubs(t)||n.isApart(t))return;const o=n.selectedNumbers.indexOf(t);-1===o?(n.selectedNumbers.push(t),n.contador+=1):(n.selectedNumbers.splice(o,1),n.contador-=1);const s=document.querySelector(`.number-button[data-number="${t}"]`);s&&s.classList.toggle("selected",-1===o)})()}openModal(){var t=this;return(0,p.A)(function*(){return yield(yield t.modalController.create({component:T,componentProps:{id_raffle:t.id_raffle,numbers:t.selectedNumbers}})).present()})()}}return(i=c).\u0275fac=function(t){return new(t||i)(e.rXU(C.nX),e.rXU(_.Qq),e.rXU(a.W3),e.rXU(e.aKT),e.rXU(a.K_))},i.\u0275cmp=e.VBU({type:i,selectors:[["app-raffle-number"]],inputs:{id_raffle:"id_raffle"},decls:33,vars:4,consts:[[3,"translucent"],["Scroll-Y","true",3,"fullscreen"],[1,"label-title"],["name","search-circle","slot","end"],["placeholder","Buscar por categoria","interface","action-sheet",3,"ionChange"],["value","available"],["value","apartados"],["value","sold"],["value","subs"],["name","search","slot","start"],["type","number","inputmode","numeric","placeholder","Buscar Numero",3,"ionChange"],["class","draggable","style","--background: #31363F;",3,"touchstart","click",4,"ngIf"],[1,"container"],[1,"card"],[1,"card-content"],[1,"numbers-container"],["class","number-button",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"draggable",2,"--background","#31363F",3,"touchstart","click"],[1,"number-button",3,"click","ngClass"]],template:function(t,n){1&t&&(e.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"Raffle-number"),e.k0s()()(),e.j41(4,"ion-content",1)(5,"ion-title",2),e.EFF(6,"Lista de Boletos"),e.k0s(),e.j41(7,"ion-item"),e.nrm(8,"ion-icon",3),e.j41(9,"ion-select",4),e.bIt("ionChange",function(s){return n.filterByCategory(s.detail.value)}),e.j41(10,"ion-select-option",5),e.EFF(11,"Tickets Disponibles"),e.k0s(),e.j41(12,"ion-select-option",6),e.EFF(13,"Tickets Apartados"),e.k0s(),e.j41(14,"ion-select-option",7),e.EFF(15,"Tickets Vendidos"),e.k0s(),e.j41(16,"ion-select-option",8),e.EFF(17,"Tickets Abonados"),e.k0s()()(),e.j41(18,"ion-item"),e.nrm(19,"ion-icon",9),e.j41(20,"ion-input",10),e.bIt("ionChange",function(s){return n.filterNumbers(s)}),e.k0s()(),e.DNE(21,O,2,1,"ion-button",11),e.nrm(22,"br"),e.qex(23),e.j41(24,"div",12)(25,"div",13)(26,"div",14)(27,"div",15),e.DNE(28,w,2,7,"button",16),e.k0s()()()(),e.bVm(),e.nrm(29,"br")(30,"br")(31,"br")(32,"br"),e.k0s()),2&t&&(e.Y8G("translucent",!0),e.R7$(4),e.Y8G("fullscreen",!0),e.R7$(17),e.Y8G("ngIf",n.isButtonVisible),e.R7$(7),e.Y8G("ngForOf",n.filteredNumbers))},dependencies:[g.YU,g.Sq,g.bT,a.Jm,a.W9,a.eU,a.iq,a.$w,a.uz,a.Nm,a.Ip,a.BC,a.ai,a.su,a.Je],styles:['@charset "UTF-8";.label-title[_ngcontent-%COMP%]{font-family:Roboto,sans-serif;font-size:30px;font-weight:700;color:#2c3e50;text-transform:uppercase;letter-spacing:1px;text-shadow:1px 1px 2px rgba(0,0,0,.1);margin-bottom:20px;text-align:center;margin-top:10px}.numbers-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center}.number-button[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;margin:5px;font-size:16px;display:flex;align-items:center;justify-content:center;border:none;outline:none;cursor:pointer;transition:background-color .3s ease;background:var(--ion-color-tertiary);color:#fff;font-family:Roboto,sans-serif;font-weight:650}.sold[_ngcontent-%COMP%]{background:var(--ion-color-danger)}.subs[_ngcontent-%COMP%]{background:#e8751a}.apart[_ngcontent-%COMP%]{background:#2c3e50}.ion-page[_ngcontent-%COMP%]{text-align:center;justify-content:center}.draggable[_ngcontent-%COMP%]{position:fixed;bottom:80px;right:20px;width:50px;height:50px;border-radius:50%!important;display:flex;justify-content:center;align-items:center;cursor:pointer;z-index:1000}#icon-float[_ngcontent-%COMP%]{font-size:30px;margin-right:3px}ion-icon[_ngcontent-%COMP%]{margin-right:5px;color:#fff;font-size:1.2em}.button-container[_ngcontent-%COMP%]{display:flex;justify-content:center}.button-paginator[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin-right:0 8px}.number-button.selected[_ngcontent-%COMP%]{background:var(--ion-color-success)}.number-button.selected.sold[_ngcontent-%COMP%]{background:var(--ion-color-danger)}.number-button.selected.subs[_ngcontent-%COMP%]{background:#e8751a}.number-button.selected.apart[_ngcontent-%COMP%]{background:#2c3e50}']}),c})()}];let G=(()=>{var i;class c{}return(i=c).\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[C.iI.forChild(V),C.iI]}),c})(),D=(()=>{var i;class c{}return(i=c).\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[g.MD,u.YN,a.bv,G,u.X1]}),c})()}}]);